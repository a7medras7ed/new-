<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠ + Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„ÙØ§ØµÙˆÙ„ÙŠØ§ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#eceef0; --panel:#ffffff; --panel-border:#dfe9f1;
  --header1:#b30000; --header2:#000000;
  --card:#f6f9fc; --card-border:#edf3f8; --text:#1d1d1d;
  --accent:#b30000; --accent-shadow:#b3000025;
  --gold1:#6e4e17; --gold2:#f2d27a; --gold3:#8a6b2f;
  --bean-bg1:#fff3c4; --bean-bg2:#e6f3ff; --bean-gold:#d6a736; --bean-gold-2:#f5d77d; --bean-blue:#2b9dff;

  /* Mascot control (smaller header, full visible) */
  --mascotW: 200px;   /* Ø­Ø¬Ù… Ø§Ù„Ø¯Ø¨Ø¯ÙˆØ¨ */
  --mascotTop: 0px;   /* ÙŠØ¨Ù‚Ù‰ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‡ÙŠØ¯Ø± (Ø¨Ø¯ÙˆÙ† Ù‚ØµÙ‘) */
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);font-family:"Cairo",system-ui,Segoe UI,Roboto,Arial,"Noto Kufi Arabic",sans-serif;color:var(--text);display:flex;align-items:flex-start;justify-content:center;min-height:100vh;padding:18px}
.wrap{width:min(1000px,96%);background:var(--panel);border-radius:24px;border:1px solid var(--panel-border);box-shadow:0 10px 30px #00000022;overflow:visible}

/* Header (compact) */
.head{
  position:relative; overflow:visible;
  display:flex; align-items:center; justify-content:center;
  background:linear-gradient(90deg,var(--header1),var(--header2));
  color:#fff;
  padding: 24px 22px 28px;   /* Ù‡ÙŠØ¯Ø± Ø£ØµØºØ± */
  min-height: 150px;         /* ÙŠØ¶Ù…Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø¯Ø¨Ø¯ÙˆØ¨ ÙƒØ§Ù…Ù„ */
}
.head img{
  position:absolute; left:18px; top: var(--mascotTop);
  width: var(--mascotW); height:auto; z-index:5; transform:scaleX(-1);
  filter: drop-shadow(0 12px 18px rgba(0,0,0,.28));
}
.title{
  position:relative; z-index:4; margin:0;
  font-weight:900; font-size:28px; letter-spacing:.3px;
  background:linear-gradient(90deg,var(--gold1),var(--gold2),var(--gold3),var(--gold2),var(--gold1));
  -webkit-background-clip:text; background-clip:text; color:transparent;
  background-size:200% auto; animation:goldflow 6s linear infinite;
  text-shadow:0 1px 0 rgba(0,0,0,.08); padding:4px 18px; border-radius:10px;
}
.title::after{
  content:""; position:absolute; inset:0;
  background:linear-gradient(100deg,transparent 0%,rgba(255,255,255,.18) 45%,rgba(255,255,255,.55) 50%,rgba(255,255,255,.18) 55%,transparent 100%);
  transform:translateX(-130%) skewX(-12deg);
  animation:shine 3.8s ease-in-out infinite; pointer-events:none; border-radius:inherit;
}

/* Daily login */
.inner{padding:18px}
.grid-panel{background:var(--card);border:1px solid var(--card-border);border-radius:20px;padding:14px}
.grid{display:grid;gap:12px;grid-template-columns:repeat(4,minmax(0,1fr))}
.grid.row2{margin-top:10px;grid-template-columns:repeat(3,minmax(0,1fr))}
@media (max-width:720px){.grid{grid-template-columns:repeat(3,1fr)}.grid.row2{grid-template-columns:repeat(3,1fr)}}
@media (max-width:520px){.grid{grid-template-columns:repeat(2,1fr)}.grid.row2{grid-template-columns:repeat(2,1fr)}}
.card{position:relative;overflow:hidden;background:#f9fbfe;border:1px solid var(--card-border);border-radius:16px;padding:10px 10px 12px;text-align:center;box-shadow:0 4px 10px #0000000e;transition:transform .15s ease}
.card:hover{transform:translateY(-2px)} .day{font-weight:800;font-size:14px;color:#7b94a6}
.icon{width:54px;height:54px;margin:8px auto 6px} .amount{font-weight:900;font-size:14px;color:#4c5f6a}
.card.active{background:linear-gradient(145deg,var(--header1),var(--header2));color:#fff;border-color:transparent}
.card.active .day{color:#fff}
.badge{display:inline-block;margin-top:6px;background:#fff;color:#b30000;padding:4px 10px;border-radius:12px;font-weight:900;font-size:14px;box-shadow:0 6px 14px var(--accent-shadow)}
.card.active::after{content:"";position:absolute;inset:0;background:linear-gradient(105deg,transparent 0%,rgba(255,255,255,.1) 44%,rgba(255,255,255,.25) 50%,rgba(255,255,255,.1) 56%,transparent 100%);transform:translateX(-130%) skewX(-10deg);animation:shimmer 3.5s ease-in-out infinite;pointer-events:none}
.check{position:absolute;top:6px;inset-inline-start:6px;width:22px;height:22px;border-radius:50%;background:linear-gradient(145deg,#fff7d6,#f1c761);border:2px solid #fff;color:#6b4f00;font-weight:900;font-size:14px;display:flex;align-items:center;justify-content:center}
.check::after{content:"âœ“"} .grand{margin-top:2px;font-size:11px;font-weight:900;color:#7b94a6}
.actions{display:flex;justify-content:center;margin-top:14px}
button.primary{position:relative;border:none;cursor:pointer;padding:12px 26px;border-radius:999px;background:linear-gradient(90deg,var(--header1),var(--header2));color:#fff;font-weight:900;font-size:16px;box-shadow:0 12px 24px var(--accent-shadow);overflow:hidden}
button.primary::after{content:"";position:absolute;inset:0;background:linear-gradient(105deg,transparent 0%,rgba(255,255,255,.18) 45%,rgba(255,255,255,.4) 50%,rgba(255,255,255,.18) 55%,transparent 100%);transform:translateX(-120%) skewX(-10deg);animation:shimmer 3.5s ease-in-out infinite;pointer-events:none}
button.primary:hover{transform:translateY(-1px)} button.primary:active{transform:translateY(0)}
.toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);background:#1b1b1b;color:#ffeaea;padding:10px 14px;border-radius:10px;font-weight:800;font-size:13px;box-shadow:0 8px 20px #00000033;opacity:0;transition:opacity .22s ease} .toast.show{opacity:1}

/* Beans section */
.beans-section{margin-top:18px;background:linear-gradient(180deg,var(--bean-bg1),var(--bean-bg2));border:1px solid #f2e6c9;border-radius:20px;padding:16px;box-shadow:0 10px 24px #102a3a12 inset,0 6px 16px #0000000e}
.beans-head{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-bottom:8px}
.beans-title{display:flex;align-items:center;gap:10px;font-weight:900;font-size:22px;color:#6a5019}
.beans-title .bean-ico{width:28px;height:28px;position:relative}
.bean-ico::before,.bean-ico::after{content:"";position:absolute;inset:0;border-radius:50% 60% 60% 50%/50% 50% 60% 60%}
.bean-ico::before{background:radial-gradient(at 30% 30%,var(--bean-gold-2),var(--bean-gold) 60%);transform:rotate(20deg);box-shadow:inset 0 -2px 4px #9a7426cc,0 2px 6px #00000022}
.bean-ico::after{background:conic-gradient(from 0deg,transparent 0 40%,#ffffffaa 45% 55%,transparent 60% 100%);animation:spin 2.8s linear infinite;mix-blend-mode:screen;border-radius:inherit}
@keyframes spin{to{transform:rotate(1turn)}}
.progress-wrap{margin:10px 0 12px}
.progress-bar{height:12px;border-radius:999px;background:#ffffffaa;overflow:hidden;border:1px solid #e9d8a6}
.progress-fill{height:100%;width:0%;background:linear-gradient(90deg,#ffcf5b,#ffd979,#fff1a6,#b3e1ff);animation:pulse 2.2s ease-in-out infinite}
@keyframes pulse{0%,100%{filter:brightness(1)}50%{filter:brightness(1.12)}}
.progress-text{display:flex;justify-content:space-between;font-weight:800;font-size:13px;color:#6b5a2a;margin-top:6px}
.levels{display:grid;gap:10px;grid-template-columns:repeat(4,minmax(0,1fr))}
@media (max-width:720px){.levels{grid-template-columns:repeat(3,1fr)}} @media (max-width:520px){.levels{grid-template-columns:repeat(2,1fr)}}
.level{background:#fffdf4;border:1px solid #f2e6c9;border-radius:14px;padding:10px;text-align:center;box-shadow:0 4px 12px #00000010}
.level .circle{width:66px;height:66px;margin:0 auto 6px;border-radius:50%;background:radial-gradient(at 40% 35%,#ffe9a9,#f2c24f 70%);border:3px solid #fff6d1;box-shadow:0 4px 10px #f6d36a88,inset 0 2px 5px #b3882d66;position:relative}
.level .circle span{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:18px;color:#6b4a12;text-shadow:0 1px 0 #fff7cc}
.level .reward{font-size:13px;color:#6a5019;font-weight:800}
.level .target{font-size:12px;color:#7c6a3d}
.level .claim{margin-top:8px;padding:8px 10px;width:100%;border:none;border-radius:10px;font-weight:900;font-size:13px;cursor:pointer;background:#2b9dff;color:#fff;box-shadow:0 6px 14px #2b9dff40}
.level .claim[disabled]{opacity:.5;cursor:not-allowed}
.level.done{border-color:#d9fbe5;background:#f5fffa}
.level.done .circle{background:radial-gradient(at 40% 35%,#d9ffd9,#6ee7a8 70%);box-shadow:0 4px 10px #6ee7a888,inset 0 2px 5px #3fa36e66}
.level.done .circle::after{content:"âœ“";position:absolute;top:-8px;right:-8px;width:22px;height:22px;border-radius:50%;background:#10b981;color:#fff;border:2px solid #fff;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:900}
.beans-footer{margin-top:12px;display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
.timer{font-weight:900;color:#6a5019}
.go{padding:10px 16px;border:none;border-radius:999px;background:#2b9dff;color:#fff;font-weight:900;cursor:pointer;box-shadow:0 8px 20px #2b9dff40}

/* Animations */
@keyframes goldflow{0%{background-position:0% 50%}100%{background-position:200% 50%}}
@keyframes shine{0%{transform:translateX(-130%) skewX(-12deg)}48%{transform:translateX(0%) skewX(-12deg)}100%{transform:translateX(130%) skewX(-12deg)}}
@keyframes shimmer{0%{transform:translateX(-120%) skewX(-10deg)}48%{transform:translateX(0%) skewX(-10deg)}100%{transform:translateX(120%) skewX(-10deg)}}

/* Responsive mascot */
@media (max-width:600px){
  :root{ --mascotW: 160px; --mascotTop: 0px; }
  .head{ min-height: 120px; padding: 18px 16px 22px; }
}

/* Milestones progress line */
.milestones-wrap{position:relative;margin:16px 6px 6px}
.milestones-track{position:relative;height:12px;border-radius:999px;background:#ffffffaa;border:1px solid #e9d8a6;overflow:hidden}
.milestones-fill{position:absolute;inset:0;height:100%;width:0%;background:linear-gradient(90deg,#ffcf5b,#ffd979,#fff1a6,#b3e1ff)}
.milestones{position:relative;margin-top:18px}
.ms{position:absolute;top:0;transform:translateX(-50%);text-align:center;width:110px;pointer-events:none}
.ms .circle{width:54px;height:54px;margin:0 auto;border-radius:50%;background:radial-gradient(at 40% 35%,#ffe9a9,#f2c24f 70%);border:3px solid #fff6d1;box-shadow:0 4px 10px #f6d36a88,inset 0 2px 5px #b3882d66;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:18px;color:#6b4a12;text-shadow:0 1px 0 #fff7cc}
.ms .ms-reward{margin-bottom:6px;font-size:12px;font-weight:900;color:#6a5019}
.ms .ms-target{margin-top:6px;font-size:12px;font-weight:800;color:#7c6a3d}
.ms.reached .circle{background:radial-gradient(at 40% 35%,#d9ffd9,#6ee7a8 70%);box-shadow:0 4px 10px #6ee7a888,inset 0 2px 5px #3fa36e66;color:#0f5132}
.ms.reached .circle::after{content:"âœ“";position:absolute;top:-8px;right:-8px;width:20px;height:20px;border-radius:50%;background:#10b981;color:#fff;border:2px solid #fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:900}
/* subtle moving shine when fill updates */
.milestones-fill::after{content:"";position:absolute;inset:0;background:linear-gradient(105deg,transparent 0%,rgba(255,255,255,.18) 45%,rgba(255,255,255,.45) 50%,rgba(255,255,255,.18) 55%,transparent 100%);transform:translateX(-120%) skewX(-10deg);animation:shimmer 3.5s ease-in-out infinite;pointer-events:none}

</style>
</head>
<body>
  <div class="wrap">
    <header class="head">
      <img src="mascot.png" alt="Mascot">
      <h1 class="title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h1>
    </header>

    <!-- Daily login -->
    <div class="inner">
      <div class="grid-panel">
        <div class="grid" id="row1"></div>
        <div class="grid row2" id="row2"></div>
      </div>
      <div class="actions"><button class="primary" id="claim">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button></div>
    </div>

    <!-- Beans Rewards -->
    <div class="inner">
      <section class="beans-section" id="beans">
        <div class="beans-head">
          <div class="beans-title">
            <span class="bean-ico"></span>
            <div>
              <div>ğŸŒŸ Ù†Ø¸Ø§Ù… Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„ÙØ§ØµÙˆÙ„ÙŠØ§ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</div>
              <div style="font-size:13px;color:#7b6a3d;font-weight:800">ğŸ¯ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø±Ø³Ù…ÙŠØ©</div>
            </div>
          </div>
          <div style="font-weight:800;font-size:13px;color:#6a5019">Ø§Ø¬Ù…Ø¹ Ø§Ù„ÙØ§ØµÙˆÙ„ÙŠØ§ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© ÙŠÙˆÙ…ÙŠÙ‹Ø§ Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ¢Øª Ø¥Ø¶Ø§ÙÙŠØ©!</div>
        </div>

        <div class="progress-text"><span>Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…</span><span id="beansLabel">0 / 120,000 ÙØ§ØµÙˆÙ„ÙŠØ§</span></div>
</div>
          <div class="progress-text"><span>Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…</span><span id="beansLabel">0 / 120,000 ÙØ§ØµÙˆÙ„ÙŠØ§</span></div>
        </div>

        <div class="milestones-wrap"><div class="milestones-track"><div class="milestones-fill" id="msFill"></div></div><div class="milestones" id="milestones"></div></div>

        <div class="beans-footer">
          <div class="timer" id="timer">â° ÙˆÙ‚Øª Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©: â€”</div>
          <button class="go" id="goBtn">Ø°Ù‡Ø§Ø¨</button>
        </div>

        <div class="dev">
          <span>Ø§Ø®ØªØ¨ÙØ± Ø¨Ø³Ø±Ø¹Ø© (Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø·):</span>
          <input type="number" id="beansInput" min="0" step="100" placeholder="Ø£Ø¯Ø®Ù„ Ø¯Ø®Ù„ Ø§Ù„ÙŠÙˆÙ…">
          <button id="beansSet">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø®Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ</button>
        </div>
      </section>
    </div>
  </div>
  <div class="toast" id="toast"></div>

<script>
/* ===== Daily Login logic ===== */
const REWARDS=[
 {g:15,desc:"Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ£Ù„Ù‚!"},
 {g:40,desc:"Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ù‡Ù…Ø©!"},
 {g:20,desc:"Ø§Ø³ØªÙ…Ø±Ø§Ø±Ùƒ ÙŠÙ„Ù…Ø¹ Ø£ÙƒØ«Ø±."},
 {g:20,desc:"Ø¯Ø¹Ù… ÙŠÙˆÙ…ÙŠ Ù…Ù† ÙØ±ÙŠÙ‚ Ø°ÙŠØ¨!"},
 {g:30,desc:"Ø§Ù‚ØªØ±Ø¨Øª Ù…Ù† Ø§Ù„Ù…ÙØ§Ø¬Ø£Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰."},
 {g:35,desc:"Ø£Ù†Øª Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„ØµØ­ÙŠØ­!"},
 {g:"random",min:30,max:1000,desc:"Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©!"}
];
const K={last:"daily.lastLoginDate",streak:"daily.streakDays"};
const todayStr=()=>{const d=new Date();return d.toISOString().split("T")[0];};
const diffDays=(a,b)=>Math.round((new Date(b+"T00:00:00")-new Date(a+"T00:00:00"))/(1000*60*60*24));
const get=(k,f=null)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):f}catch{return f}};
const set=(k,v)=>localStorage.setItem(k,JSON.stringify(v));
function diamondSVG(size=54){return `<svg viewBox="0 0 100 100" width="${size}" height="${size}" aria-hidden="true"><polygon points="20,15 80,15 95,40 50,95 5,40" fill="#ffbaba" stroke="#ffcccc" stroke-width="2"/><polyline points="20,15 50,55 80,15" fill="none" stroke="#fff2f2" stroke-width="2"/><polyline points="5,40 50,40 95,40" fill="none" stroke="#fff2f2" stroke-width="2"/></svg>`;}
function chestSVG(size=54){return `<svg viewBox="0 0 120 100" width="${size}" height="${size}" aria-hidden="true"><rect x="10" y="40" width="100" height="45" rx="6" fill="#ffb84d" stroke="#b30000" stroke-width="3"/><rect x="10" y="30" width="100" height="20" rx="6" fill="#ff9933" stroke="#b30000" stroke-width="3"/><polygon points="60,18 70,30 50,30" fill="#ffe066"/></svg>`;}
const row1=document.getElementById("row1"), row2=document.getElementById("row2"); let cards=[];
function makeCard(i){const d=i+1, info=REWARDS[i], amt=info.g==="random"?"30~1000":info.g;
  const c=document.createElement("div"); c.className="card"; c.dataset.i=i;
  c.innerHTML=`<div class="day">ÙŠÙˆÙ… ${d}</div><div class="icon">${i===6?chestSVG():diamondSVG()}</div><div id="amt-${i}" class="amount">ğŸ’ ${amt} ${info.g==="random"?"":"Ù…Ø§Ø³Ø©"}</div>${i===6?'<div class="grand">Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰</div>':''}`;
  return c;
}
function buildLogin(){row1.innerHTML="";row2.innerHTML="";cards=[];for(let i=0;i<7;i++){const c=makeCard(i);(i<4?row1:row2).appendChild(c);cards.push(c);}}
buildLogin();
function stateLogin(){const last=get(K.last,null),st=Number(get(K.streak,0))||0,t=todayStr();if(!last)return{streak:st,can:true,glow:0,reset:false};const d=diffDays(last,t);if(d===0)return{streak:st,can:false,glow:Math.min(st,6),reset:false};if(d===1)return{streak:st,can:true,glow:Math.min(st,6),reset:false};if(d>1)return{streak:0,can:true,glow:0,reset:true};return{streak:st,can:false,glow:Math.min(st,6),reset:false};}
function updateLogin(){const s=stateLogin();cards.forEach(c=>{c.classList.remove("active");const ch=c.querySelector(".check");if(ch)ch.remove();});for(let i=0;i<s.streak&&i<7;i++){const m=document.createElement("div");m.className="check";cards[i].appendChild(m);}const idx=Math.min(s.glow,6);cards[idx].classList.add("active");const a=document.getElementById(`amt-${idx}`);if(a){a.classList.add("badge");a.classList.remove("amount");}for(let i=0;i<7;i++){if(i===idx)continue;const x=document.getElementById(`amt-${i}`);if(x){x.classList.add("amount");x.classList.remove("badge");}}document.getElementById("claim").disabled=!s.can;}
updateLogin();
function toast(msg){const t=document.getElementById("toast");t.textContent=msg;t.classList.add("show");setTimeout(()=>t.classList.remove("show"),2000);}
function reward(i){const r=REWARDS[i];if(r.g==="random"){const v=Math.floor(Math.random()*(r.max-r.min+1))+r.min;return{msg:`ğŸ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ${v} Ù…Ø§Ø³Ø© (Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰)!`};}return{msg:`ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… ${r.g} Ù…Ø§Ø³Ø© â€” ${r.desc}`};}
document.getElementById("claim").addEventListener("click",()=>{const s=stateLogin();if(!s.can){toast("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„ÙØ¹Ù„.");return;}let st=s.streak;if(s.reset)st=0;const idx=Math.min(st,6), r=reward(idx);set(K.last,todayStr());set(K.streak,idx===6?7:st+1);toast(`ğŸ’ ${r.msg}`);updateLogin();});

/* ===== Beans Rewards logic (Milestones version) ===== */
const B={lastReset:"beans.lastResetDate",amount:"beans.daily.amount"};
const LEVELS=[
 {n:1,target:2000,reward:200},
 {n:2,target:4500,reward:450},
 {n:3,target:11000,reward:1000},
 {n:4,target:25500,reward:2000},
 {n:5,target:50000,reward:3000},
 {n:6,target:80000,reward:5000},
 {n:7,target:100000,reward:7500},
 {n:8,target:120000,reward:10000,trophy:true}
];
const MAX_TARGET=LEVELS[LEVELS.length-1].target;
function resetIfNewDay(){const last=get(B.lastReset,null),t=todayStr();if(last!==t){set(B.lastReset,t);set(B.amount,0);}}
resetIfNewDay();
const beans=()=>Number(get(B.amount,0))||0, setBeans=v=>set(B.amount,Math.max(0,Math.floor(v)));
const fmt=n=>n.toLocaleString('ar-EG');

const msWrap=document.getElementById('milestones');
function buildMilestones(){
  msWrap.innerHTML="";
  LEVELS.forEach(L=>{
    const pct = Math.max(0,Math.min(100,(L.target/MAX_TARGET)*100));
    const d = document.createElement('div');
    d.className='ms';
    d.style.left = pct + '%';
    d.dataset.n = L.n;
    d.innerHTML = `
      <div class="ms-reward">ğŸ ${fmt(L.reward)} ÙØ§ØµÙˆÙ„ÙŠØ§</div>
      <div class="circle">${L.n}${L.trophy?'ğŸ†':''}</div>
      <div class="ms-target">Ø§Ù„Ù‡Ø¯Ù: ${fmt(L.target)}</div>
    `;
    msWrap.appendChild(d);
  });
}
buildMilestones();

function updateBeansUI(){
  const a = beans();
  const pct = Math.max(0,Math.min(100,(a/MAX_TARGET)*100));
  document.getElementById('msFill').style.width = pct + '%';
  
  document.getElementById('beansLabel').textContent = `${fmt(a)} / ${fmt(MAX_TARGET)} ÙØ§ØµÙˆÙ„ÙŠØ§`;
  LEVELS.forEach(L=>{
    const d = document.querySelector(`.ms[data-n="${L.n}"]`);
    if(!d) return;
    d.classList.toggle('reached', a >= L.target);
  });
}
updateBeansUI();

function nextMidnight(){const n=new Date();return new Date(n.getFullYear(),n.getMonth(),n.getDate()+1,0,0,0,0);} const two=n=>n<10?"0"+n:""+n;
function tick(){const ms=nextMidnight()-new Date();if(ms<=0){resetIfNewDay();updateBeansUI();}const s=Math.max(0,Math.floor(ms/1000)),h=Math.floor(s/3600),m=Math.floor((s%3600)/60);document.getElementById('timer').textContent=`â° ÙˆÙ‚Øª Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©: ${two(h)} Ø³Ø§Ø¹Ø§Øª Ùˆ${two(m)} Ø¯Ù‚ÙŠÙ‚Ø©`;setTimeout(tick,1000);} tick();
document.getElementById('beansSet').addEventListener('click',()=>{const v=Number(document.getElementById('beansInput').value||0);setBeans(v);updateBeansUI();toast("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø®Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ (Ø¹Ø±Ø¶ ÙÙ‚Ø·).");});
document.getElementById('goBtn').addEventListener('click',()=>{toast("Ø¬Ø§Ø±Ù Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù†Ø´Ø§Ø·..."); /* location.href='/activity'; */});
const B={lastReset:"beans.lastResetDate",amount:"beans.daily.amount",claims:"beans.daily.claims"};
const LEVELS=[
 {n:1,target:2000,reward:200},{n:2,target:4500,reward:450},{n:3,target:11000,reward:1000},{n:4,target:25500,reward:2000},
 {n:5,target:50000,reward:3000},{n:6,target:80000,reward:5000},{n:7,target:100000,reward:7500},{n:8,target:120000,reward:10000,trophy:true}
];
const MAX_TARGET=LEVELS[LEVELS.length-1].target;
function resetIfNewDay(){const last=get(B.lastReset,null),t=todayStr();if(last!==t){set(B.lastReset,t);set(B.amount,0);set(B.claims,{});}}
resetIfNewDay();
const beans=()=>Number(get(B.amount,0))||0, setBeans=v=>set(B.amount,Math.max(0,Math.floor(v))), claims=()=>get(B.claims,{})||{}, setClaimed=n=>{const c=claims();c[n]=true;set(B.claims,c)};
const levelsWrap=document.getElementById('levels');
function buildLevels(){levelsWrap.innerHTML="";LEVELS.forEach(L=>{const d=document.createElement('div');d.className='level';d.dataset.n=L.n;d.innerHTML=`<div class="circle"><span>${L.n}${L.trophy?'ğŸ†':''}</span></div><div class="reward">ğŸ ${L.reward.toLocaleString()} ÙØ§ØµÙˆÙ„ÙŠØ§</div><div class="target">Ø§Ù„Ù‡Ø¯Ù: ${L.target.toLocaleString()} ÙØ§ØµÙˆÙ„ÙŠØ§</div><button class="claim" id="claimL${L.n}">Ø§Ø³ØªÙ„Ø§Ù…</button>`;levelsWrap.appendChild(d);});}
buildLevels();
const fmt=n=>n.toLocaleString('ar-EG');
function updateBeansUI(){const a=beans(), pct=Math.max(0,Math.min(100,(a/MAX_TARGET)*100));document.getElementById('beansFill').style.width=pct+'%';document.getElementById('beansLabel').textContent=`${fmt(a)} / ${fmt(MAX_TARGET)} ÙØ§ØµÙˆÙ„ÙŠØ§`;LEVELS.forEach(L=>{const d=document.querySelector(`.level[data-n="${L.n}"]`), b=document.getElementById(`claimL${L.n}`), reached=a>=L.target, already=!!claims()[L.n];d.classList.toggle('done',already);b.disabled=!(reached&&!already);b.textContent=already?"ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… âœ“":(reached?"Ø§Ø³ØªÙ„Ø§Ù…":"ØºÙŠØ± Ù…ØªØ§Ø­");});}
updateBeansUI();
LEVELS.forEach(L=>{document.getElementById(`claimL${L.n}`).addEventListener('click',()=>{const a=beans();if(a<L.target){toast("Ù„Ù… ØªØµÙ„ Ù„Ù„Ù‡Ø¯Ù Ø¨Ø¹Ø¯.");return;}if(claims()[L.n]){toast("ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ø³Ø¨Ù‚Ù‹Ø§.");return;}setClaimed(L.n);toast(`âœ… ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${L.n}: +${fmt(L.reward)} ÙØ§ØµÙˆÙ„ÙŠØ§`);updateBeansUI();});});
function nextMidnight(){const n=new Date();return new Date(n.getFullYear(),n.getMonth(),n.getDate()+1,0,0,0,0);} const two=n=>n<10?"0"+n:""+n;
function tick(){const ms=nextMidnight()-new Date();if(ms<=0){resetIfNewDay();updateBeansUI();}const s=Math.max(0,Math.floor(ms/1000)),h=Math.floor(s/3600),m=Math.floor((s%3600)/60);document.getElementById('timer').textContent=`â° ÙˆÙ‚Øª Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©: ${two(h)} Ø³Ø§Ø¹Ø§Øª Ùˆ${two(m)} Ø¯Ù‚ÙŠÙ‚Ø©`;setTimeout(tick,1000);} tick();
document.getElementById('beansSet').addEventListener('click',()=>{const v=Number(document.getElementById('beansInput').value||0);setBeans(v);updateBeansUI();toast("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø®Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ (Ø¹Ø±Ø¶ ÙÙ‚Ø·).");});
document.getElementById('goBtn').addEventListener('click',()=>{toast("Ø¬Ø§Ø±Ù Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù†Ø´Ø§Ø·..."); /* location.href='/activity'; */});
</script>
</body>
</html>
